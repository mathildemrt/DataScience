{"paragraphs":[{"text":"%md\n### First steps with Hive\n\nCreate your database on hive. We will name it with your EPFL gaspar name.\n\n```shell\n%jdbc(hive)\ncreate database if not exists your_gaspar_name\n  location '/user/your_gaspar_name/hive'; \n```\n\nCreate an external Hive table. Hive will create a reference to the files but it will not manage the files itself. If you drop the table, only the definition in Hive is deleted. This exercise will work only if you have completed the HDFS exercises.\n\n```shell\n%jdbc(hive)\ncreate external table if not exists your_gaspar_name.traffic_count(Sdate string,Cosit int,Study int,Period int,LaneNumber int,LaneDescription string,LaneDirection int,DirectionDescription string,Volume int,Flags int,FlagText string,Setup int,NumBins int,Bins int)\n    row format delimited fields terminated by ','\n    stored as textfile\n    location '/user/your_gaspar_name/work1/';\n```\n\nNow verify that your table was properly created.\n```shell\n%jdbc(hive)\nselect * from your_gaspar_name.traffic_count limit 10;\n```\n\nReplace your_gaspar_name with your username and try the above commands in the next cells, create as many cells as needed.\n\nNote the first row. what did we do wrong?\n","user":"mareite","dateUpdated":"2018-03-21T14:55:22+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>First steps with Hive</h3>\n<p>Create your database on hive. We will name it with your EPFL gaspar name.</p>\n<pre><code class=\"shell\">%jdbc(hive)\ncreate database if not exists your_gaspar_name\n  location '/user/your_gaspar_name/hive'; \n</code></pre>\n<p>Create an external Hive table. Hive will create a reference to the files but it will not manage the files itself. If you drop the table, only the definition in Hive is deleted. This exercise will work only if you have completed the HDFS exercises.</p>\n<pre><code class=\"shell\">%jdbc(hive)\ncreate external table if not exists your_gaspar_name.traffic_count(Sdate string,Cosit int,Study int,Period int,LaneNumber int,LaneDescription string,LaneDirection int,DirectionDescription string,Volume int,Flags int,FlagText string,Setup int,NumBins int,Bins int)\n    row format delimited fields terminated by ','\n    stored as textfile\n    location '/user/your_gaspar_name/work1/';\n</code></pre>\n<p>Now verify that your table was properly created.</p>\n<pre><code class=\"shell\">%jdbc(hive)\nselect * from your_gaspar_name.traffic_count limit 10;\n</code></pre>\n<p>Replace your_gaspar_name with your username and try the above commands in the next cells, create as many cells as needed.</p>\n<p>Note the first row. what did we do wrong?</p>\n"}]},"apps":[],"jobName":"paragraph_1521640132566_89099756","id":"20180320-102737_103167059","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T14:55:22+0100","dateFinished":"2018-03-21T14:55:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:399"},{"text":"%jdbc(hive)\ncreate database if not exists mareite\n  location '/user/mareite/hive';","user":"mareite","dateUpdated":"2018-03-21T15:32:25+0100","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1521640132567_88715007","id":"20180321-025846_71567959","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T15:32:25+0100","dateFinished":"2018-03-21T15:32:25+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"text":"%jdbc(hive)\ncreate external table if not exists mareite.traffic_count(Sdate string,Cosit int,Study int,Period int,LaneNumber int,LaneDescription string,LaneDirection int,DirectionDescription string,Volume int,Flags int,FlagText string,Setup int,NumBins int,Bins int)\n    row format delimited fields terminated by ','\n    stored as textfile\n    location '/user/mareite/work1/';","user":"mareite","dateUpdated":"2018-03-21T15:41:11+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1521641189946_-1152395765","id":"20180321-150629_290295808","dateCreated":"2018-03-21T15:06:29+0100","dateStarted":"2018-03-21T15:40:09+0100","dateFinished":"2018-03-21T15:40:09+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"text":"%jdbc(hive)\nselect * from mareite.traffic_count limit 10;","user":"mareite","dateUpdated":"2018-03-21T15:40:13+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"traffic_count.sdate\ttraffic_count.cosit\ttraffic_count.study\ttraffic_count.period\ttraffic_count.lanenumber\ttraffic_count.lanedescription\ttraffic_count.lanedirection\ttraffic_count.directiondescription\ttraffic_count.volume\ttraffic_count.flags\ttraffic_count.flagtext\ttraffic_count.setup\ttraffic_count.numbins\ttraffic_count.bins\nSdate\tnull\tnull\tnull\tnull\tLaneDescription\tnull\tDirectionDescription\tnull\tnull\tFlag Text\tnull\tnull\tnull\n26/07/2016 12:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t-1\t10240\t\"Bad data\tnull\t1\t0\n26/07/2016 12:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t-1\t10240\t\"Bad data\tnull\t1\t0\n26/07/2016 13:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t70\t8192\tChecked\t1\t0\tnull\n26/07/2016 13:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t79\t8192\tChecked\t1\t0\tnull\n26/07/2016 14:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t96\t8192\tChecked\t1\t0\tnull\n26/07/2016 14:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t102\t8192\tChecked\t1\t0\tnull\n26/07/2016 15:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t95\t8192\tChecked\t1\t0\tnull\n26/07/2016 15:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t96\t8192\tChecked\t1\t0\tnull\n26/07/2016 16:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t106\t8192\tChecked\t1\t0\tnull\n"}]},"apps":[],"jobName":"paragraph_1521641161943_-2021574178","id":"20180321-150601_1411786303","dateCreated":"2018-03-21T15:06:01+0100","dateStarted":"2018-03-21T15:40:13+0100","dateFinished":"2018-03-21T15:40:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:402"},{"text":"%md \nForget to skip header row while creating the table \nAdd tblproperties (\"skip.header.line.count\"=\"1\");","user":"mareite","dateUpdated":"2018-03-21T15:39:47+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Forget to skip header row while creating the table\n<br  />Add tblproperties (&ldquo;skip.header.line.count&rdquo;=&ldquo;1&rdquo;);</p>\n"}]},"apps":[],"jobName":"paragraph_1521643040617_983993929","id":"20180321-153720_1460107414","dateCreated":"2018-03-21T15:37:20+0100","dateStarted":"2018-03-21T15:39:47+0100","dateFinished":"2018-03-21T15:39:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"text":"%jdbc(hive)\ndrop table if exists mareite.traffic_count;\n\ncreate external table if not exists mareite.traffic_count(Sdate string,Cosit int,Study int,Period int,LaneNumber int,LaneDescription string,LaneDirection int,DirectionDescription string,Volume int,Flags int,FlagText string,Setup int,NumBins int,Bins int)\n    row format delimited fields terminated by ','\n    stored as textfile\n    location '/user/mareite/work1/'\n    tblproperties (\"skip.header.line.count\"=\"1\");\n\nselect * from mareite.traffic_count limit 10;\n","user":"mareite","dateUpdated":"2018-03-21T15:43:43+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"traffic_count.sdate\ttraffic_count.cosit\ttraffic_count.study\ttraffic_count.period\ttraffic_count.lanenumber\ttraffic_count.lanedescription\ttraffic_count.lanedirection\ttraffic_count.directiondescription\ttraffic_count.volume\ttraffic_count.flags\ttraffic_count.flagtext\ttraffic_count.setup\ttraffic_count.numbins\ttraffic_count.bins\n26/07/2016 12:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t-1\t10240\t\"Bad data\tnull\t1\t0\n26/07/2016 12:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t-1\t10240\t\"Bad data\tnull\t1\t0\n26/07/2016 13:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t70\t8192\tChecked\t1\t0\tnull\n26/07/2016 13:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t79\t8192\tChecked\t1\t0\tnull\n26/07/2016 14:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t96\t8192\tChecked\t1\t0\tnull\n26/07/2016 14:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t102\t8192\tChecked\t1\t0\tnull\n26/07/2016 15:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t95\t8192\tChecked\t1\t0\tnull\n26/07/2016 15:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t96\t8192\tChecked\t1\t0\tnull\n26/07/2016 16:00\t70301\t1\t60\t1\tNorthbound\t1\tNorthEast\t106\t8192\tChecked\t1\t0\tnull\n26/07/2016 16:00\t70301\t1\t60\t2\tSouthbound\t2\tSouthWest\t136\t8192\tChecked\t1\t0\tnull\n"}]},"apps":[],"jobName":"paragraph_1521643253716_1755414123","id":"20180321-154053_843813373","dateCreated":"2018-03-21T15:40:53+0100","dateStarted":"2018-03-21T15:43:43+0100","dateFinished":"2018-03-21T15:43:43+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:404"},{"text":"%md\n### Import one day of Twitter data into Hive\n\nCreate an external table  from HDFS dir __/datasets/twitter_one_day__ and call it __twitter_one_day__. The table should have a single column named __json__ of type __string__. Do not forget to use your own database (gaspar name)!\n\nA few hints:\n(1) You can explore the __/datasets/twitter_one_day__ directory from your terminal with the __hdfs dfs -ls__ command. You will notice that the files are in bzip2 format. Do not worry about that, Hive knows how to handle compressed text files automatically.\n(2) The files have only one field per line\n(3) If you do not specify the row format, the default format __fields terminated by '\\n'__ will be used.\n\nAfter the table __twitter_one_day__ is created, verify the content of its first row with a select command (limit 1). Use the output of the select query to identify the json fields where the the language and the timestamp information of the tweet are stored. You can use __http://jsonprettyprint.com/__ to pretty print the json string.\n\n","user":"mareite","dateUpdated":"2018-03-21T15:37:51+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Import one day of Twitter data into Hive</h3>\n<p>Create an external table  from HDFS dir <strong>/datasets/twitter_one_day</strong> and call it <strong>twitter_one_day</strong>. The table should have a single column named <strong>json</strong> of type <strong>string</strong>. Do not forget to use your own database (gaspar name)!</p>\n<p>A few hints:\n<br  />(1) You can explore the <strong>/datasets/twitter_one_day</strong> directory from your terminal with the <strong>hdfs dfs -ls</strong> command. You will notice that the files are in bzip2 format. Do not worry about that, Hive knows how to handle compressed text files automatically.\n<br  />(2) The files have only one field per line\n<br  />(3) If you do not specify the row format, the default format <strong>fields terminated by '\\n'</strong> will be used.</p>\n<p>After the table <strong>twitter_one_day</strong> is created, verify the content of its first row with a select command (limit 1). Use the output of the select query to identify the json fields where the the language and the timestamp information of the tweet are stored. You can use <strong>http://jsonprettyprint.com/</strong> to pretty print the json string.</p>\n"}]},"apps":[],"jobName":"paragraph_1521640132567_88715007","id":"20180320-133148_586015451","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T15:37:51+0100","dateFinished":"2018-03-21T15:37:51+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:405"},{"text":"%jdbc(hive)\ndrop table if exists mareite.twitter_one_day;\n\ncreate external table if not exists mareite.twitter_one_day(json string)\n    row format delimited fields terminated by '\\n'\n    stored as textfile\n    location '/datasets/twitter_one_day/';\n    \nselect * from mareite.twitter_one_day limit 1;","user":"mareite","dateUpdated":"2018-03-21T15:49:25+0100","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"twitter_one_day.json\n{\"created_at\":\"Sat Nov 11 07:30:00 +0000 2017\",\"id\":929249838012571648,\"id_str\":\"929249838012571648\",\"text\":\"RT @President1Trump: Our FABULOUS @FLOTUS \\ud83e\\udd8bPasses out toy eagles \\ud83e\\udd85 to  children in Beijing! https:\\/\\/t.co\\/GCdCzwe4ea\",\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":799120640733085696,\"id_str\":\"799120640733085696\",\"name\":\"Margarta Murillo\",\"screen_name\":\"MargartaMurillo\",\"location\":null,\"url\":null,\"description\":null,\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":46,\"friends_count\":82,\"listed_count\":0,\"favourites_count\":3769,\"statuses_count\":6859,\"created_at\":\"Thu Nov 17 05:23:02 +0000 2016\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":false,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"F5F8FA\",\"profile_background_image_url\":\"\",\"profile_background_image_url_https\":\"\",\"profile_background_tile\":false,\"profile_link_color\":\"1DA1F2\",\"profile_sidebar_border_color\":\"C0DEED\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/abs.twimg.com\\/sticky\\/default_profile_images\\/default_profile_normal.png\",\"profile_image_url_https\":\"https:\\/\\/abs.twimg.com\\/sticky\\/default_profile_images\\/default_profile_normal.png\",\"default_profile\":true,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"retweeted_status\":{\"created_at\":\"Fri Nov 10 18:21:18 +0000 2017\",\"id\":929051353736982528,\"id_str\":\"929051353736982528\",\"text\":\"Our FABULOUS @FLOTUS \\ud83e\\udd8bPasses out toy eagles \\ud83e\\udd85 to  children in Beijing! https:\\/\\/t.co\\/GCdCzwe4ea\",\"source\":\"\\u003ca href=\\\"http:\\/\\/twitter.com\\/download\\/iphone\\\" rel=\\\"nofollow\\\"\\u003eTwitter for iPhone\\u003c\\/a\\u003e\",\"truncated\":false,\"in_reply_to_status_id\":null,\"in_reply_to_status_id_str\":null,\"in_reply_to_user_id\":null,\"in_reply_to_user_id_str\":null,\"in_reply_to_screen_name\":null,\"user\":{\"id\":763935668284239872,\"id_str\":\"763935668284239872\",\"name\":\"'GITMO' BAMA \\ud83d\\udd4a\\ud83c\\uddfa\\ud83c\\uddf8\\ud83d\\udd4a\",\"screen_name\":\"President1Trump\",\"location\":\"USA\",\"url\":null,\"description\":\"Follow 45 \\ud83c\\uddfa\\ud83c\\uddf8@President2Trump @RealDonaldTrump the 45th President of the United States of America \\ud83c\\uddfa\\ud83c\\uddf8 \\u271d\\ufe0f\\ud83d\\udc9f\\u2721\\ufe0f\",\"translator_type\":\"none\",\"protected\":false,\"verified\":false,\"followers_count\":28308,\"friends_count\":18778,\"listed_count\":144,\"favourites_count\":151029,\"statuses_count\":115590,\"created_at\":\"Fri Aug 12 03:10:31 +0000 2016\",\"utc_offset\":null,\"time_zone\":null,\"geo_enabled\":false,\"lang\":\"en\",\"contributors_enabled\":false,\"is_translator\":false,\"profile_background_color\":\"F5F8FA\",\"profile_background_image_url\":\"\",\"profile_background_image_url_https\":\"\",\"profile_background_tile\":false,\"profile_link_color\":\"1DA1F2\",\"profile_sidebar_border_color\":\"C0DEED\",\"profile_sidebar_fill_color\":\"DDEEF6\",\"profile_text_color\":\"333333\",\"profile_use_background_image\":true,\"profile_image_url\":\"http:\\/\\/pbs.twimg.com\\/profile_images\\/929165126917242885\\/B7tFgMnO_normal.jpg\",\"profile_image_url_https\":\"https:\\/\\/pbs.twimg.com\\/profile_images\\/929165126917242885\\/B7tFgMnO_normal.jpg\",\"profile_banner_url\":\"https:\\/\\/pbs.twimg.com\\/profile_banners\\/763935668284239872\\/1510064036\",\"default_profile\":true,\"default_profile_image\":false,\"following\":null,\"follow_request_sent\":null,\"notifications\":null},\"geo\":null,\"coordinates\":null,\"place\":null,\"contributors\":null,\"is_quote_status\":false,\"quote_count\":61,\"reply_count\":119,\"retweet_count\":1309,\"favorite_count\":2360,\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"FLOTUS\",\"name\":\"Melania Trump\",\"id\":818876014390603776,\"id_str\":\"818876014390603776\",\"indices\":[13,20]}],\"symbols\":[],\"media\":[{\"id\":929040513323425792,\"id_str\":\"929040513323425792\",\"indices\":[71,94],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"url\":\"https:\\/\\/t.co\\/GCdCzwe4ea\",\"display_url\":\"pic.twitter.com\\/GCdCzwe4ea\",\"expanded_url\":\"https:\\/\\/twitter.com\\/NBCNews\\/status\\/929046002220244992\\/video\\/1\",\"type\":\"photo\",\"sizes\":{\"small\":{\"w\":340,\"h\":340,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":600,\"resize\":\"fit\"},\"large\":{\"w\":720,\"h\":720,\"resize\":\"fit\"}},\"source_status_id\":929046002220244992,\"source_status_id_str\":\"929046002220244992\",\"source_user_id\":14173315,\"source_user_id_str\":\"14173315\"}]},\"extended_entities\":{\"media\":[{\"id\":929040513323425792,\"id_str\":\"929040513323425792\",\"indices\":[71,94],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"url\":\"https:\\/\\/t.co\\/GCdCzwe4ea\",\"display_url\":\"pic.twitter.com\\/GCdCzwe4ea\",\"expanded_url\":\"https:\\/\\/twitter.com\\/NBCNews\\/status\\/929046002220244992\\/video\\/1\",\"type\":\"video\",\"sizes\":{\"small\":{\"w\":340,\"h\":340,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":600,\"resize\":\"fit\"},\"large\":{\"w\":720,\"h\":720,\"resize\":\"fit\"}},\"source_status_id\":929046002220244992,\"source_status_id_str\":\"929046002220244992\",\"source_user_id\":14173315,\"source_user_id_str\":\"14173315\",\"video_info\":{\"aspect_ratio\":[1,1],\"duration_millis\":26159,\"variants\":[{\"bitrate\":320000,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/vid\\/240x240\\/FhMhzFMT4NZohIwN.mp4\"},{\"bitrate\":1280000,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/vid\\/720x720\\/dfKAUHeV4l1bQbq6.mp4\"},{\"bitrate\":832000,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/vid\\/480x480\\/Fmh_qmGoeUyZQzNb.mp4\"},{\"content_type\":\"application\\/x-mpegURL\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/pl\\/BBLF8OMQxMREMvrZ.m3u8\"}]}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\"},\"is_quote_status\":false,\"quote_count\":0,\"reply_count\":0,\"retweet_count\":0,\"favorite_count\":0,\"entities\":{\"hashtags\":[],\"urls\":[],\"user_mentions\":[{\"screen_name\":\"President1Trump\",\"name\":\"'GITMO' BAMA \\ud83d\\udd4a\\ud83c\\uddfa\\ud83c\\uddf8\\ud83d\\udd4a\",\"id\":763935668284239872,\"id_str\":\"763935668284239872\",\"indices\":[3,19]},{\"screen_name\":\"FLOTUS\",\"name\":\"Melania Trump\",\"id\":818876014390603776,\"id_str\":\"818876014390603776\",\"indices\":[34,41]}],\"symbols\":[],\"media\":[{\"id\":929040513323425792,\"id_str\":\"929040513323425792\",\"indices\":[92,115],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"url\":\"https:\\/\\/t.co\\/GCdCzwe4ea\",\"display_url\":\"pic.twitter.com\\/GCdCzwe4ea\",\"expanded_url\":\"https:\\/\\/twitter.com\\/NBCNews\\/status\\/929046002220244992\\/video\\/1\",\"type\":\"photo\",\"sizes\":{\"small\":{\"w\":340,\"h\":340,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":600,\"resize\":\"fit\"},\"large\":{\"w\":720,\"h\":720,\"resize\":\"fit\"}},\"source_status_id\":929046002220244992,\"source_status_id_str\":\"929046002220244992\",\"source_user_id\":14173315,\"source_user_id_str\":\"14173315\"}]},\"extended_entities\":{\"media\":[{\"id\":929040513323425792,\"id_str\":\"929040513323425792\",\"indices\":[92,115],\"media_url\":\"http:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"media_url_https\":\"https:\\/\\/pbs.twimg.com\\/amplify_video_thumb\\/929040513323425792\\/img\\/KNWqtrVnV8pgmDGG.jpg\",\"url\":\"https:\\/\\/t.co\\/GCdCzwe4ea\",\"display_url\":\"pic.twitter.com\\/GCdCzwe4ea\",\"expanded_url\":\"https:\\/\\/twitter.com\\/NBCNews\\/status\\/929046002220244992\\/video\\/1\",\"type\":\"video\",\"sizes\":{\"small\":{\"w\":340,\"h\":340,\"resize\":\"fit\"},\"thumb\":{\"w\":150,\"h\":150,\"resize\":\"crop\"},\"medium\":{\"w\":600,\"h\":600,\"resize\":\"fit\"},\"large\":{\"w\":720,\"h\":720,\"resize\":\"fit\"}},\"source_status_id\":929046002220244992,\"source_status_id_str\":\"929046002220244992\",\"source_user_id\":14173315,\"source_user_id_str\":\"14173315\",\"video_info\":{\"aspect_ratio\":[1,1],\"duration_millis\":26159,\"variants\":[{\"bitrate\":320000,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/vid\\/240x240\\/FhMhzFMT4NZohIwN.mp4\"},{\"bitrate\":1280000,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/vid\\/720x720\\/dfKAUHeV4l1bQbq6.mp4\"},{\"bitrate\":832000,\"content_type\":\"video\\/mp4\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/vid\\/480x480\\/Fmh_qmGoeUyZQzNb.mp4\"},{\"content_type\":\"application\\/x-mpegURL\",\"url\":\"https:\\/\\/video.twimg.com\\/amplify_video\\/929040513323425792\\/pl\\/BBLF8OMQxMREMvrZ.m3u8\"}]}}]},\"favorited\":false,\"retweeted\":false,\"possibly_sensitive\":false,\"filter_level\":\"low\",\"lang\":\"en\",\"timestamp_ms\":\"1510385400666\"}\n"}]},"apps":[],"jobName":"paragraph_1521640132568_86791263","id":"20180321-030249_154474664","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T15:49:25+0100","dateFinished":"2018-03-21T15:49:26+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:406"},{"text":"%md \nLast 2 json fields are : \n* \"lang\": \"en\",\n* \"timestamp_ms\": \"1510385400666\"","user":"mareite","dateUpdated":"2018-03-21T15:56:36+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>Last 2 json fields are :</p>\n<ul>\n<li>&ldquo;lang&rdquo;: &ldquo;en&rdquo;,</li>\n<li>&ldquo;timestamp_ms&rdquo;: &ldquo;1510385400666&rdquo;</li>\n</ul>\n"}]},"apps":[],"jobName":"paragraph_1521644153862_791722109","id":"20180321-155553_1284559593","dateCreated":"2018-03-21T15:55:53+0100","dateStarted":"2018-03-21T15:56:36+0100","dateFinished":"2018-03-21T15:56:36+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:407"},{"text":"%md\n### Twitter language frequency\n\nCompute the language frequencies, sorted in decreasing order of popularity. You should only use standard SQL group and count commands.\n\nTake advantage of the Zeppelin graph toolbar that appears with the results.\n\n```shell\n%jdbc(hive)\nwith q as (\n    select\n        get_json_object(json, '$.lang') as lang\n    from CHANGEME.twitter_one_day\n)\n\nselect lang, count(*) as count\nfrom q\ngroup by lang\norder by count desc;\n```\n\nYou can try different visualizations of the results with the embedded Zeppelin graph interface.\n\nFor further reading see the distinction between __group by__ and __sort by__ in __https://cwiki.apache.org/confluence/display/Hive/LanguageManual+SortBy__ . You can try this at home.\n","user":"mareite","dateUpdated":"2018-03-21T15:56:40+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":true,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"lang","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Twitter language frequency</h3>\n<p>Compute the language frequencies, sorted in decreasing order of popularity. You should only use standard SQL group and count commands.</p>\n<p>Take advantage of the Zeppelin graph toolbar that appears with the results.</p>\n<pre><code class=\"shell\">%jdbc(hive)\nwith q as (\n    select\n        get_json_object(json, '$.lang') as lang\n    from CHANGEME.twitter_one_day\n)\n\nselect lang, count(*) as count\nfrom q\ngroup by lang\norder by count desc;\n</code></pre>\n<p>You can try different visualizations of the results with the embedded Zeppelin graph interface.</p>\n<p>For further reading see the distinction between <strong>group by</strong> and <strong>sort by</strong> in <strong>https://cwiki.apache.org/confluence/display/Hive/LanguageManual+SortBy</strong> . You can try this at home.</p>\n"}]},"apps":[],"jobName":"paragraph_1521640132568_86791263","id":"20180320-135324_2117720219","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T15:56:40+0100","dateFinished":"2018-03-21T15:56:40+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:408"},{"text":"%jdbc(hive)\nwith q as (\n    select\n        get_json_object(json, '$.lang') as lang\n    from mareite.twitter_one_day\n)\n\nselect lang, count(*) as count\nfrom q\ngroup by lang\norder by count desc;","user":"mareite","dateUpdated":"2018-03-21T16:03:58+0100","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"lang\tcount\nen\t1000596\nnull\t904724\nja\t681507\nar\t263575\nes\t238278\nund\t214158\npt\t190038\nko\t174870\nth\t111280\nfr\t63765\nin\t59658\ntr\t51658\ntl\t42213\nzh\t23703\nru\t21566\nit\t15748\nhi\t14164\nde\t12345\npl\t9509\nnl\t7706\nfa\t4195\nht\t4148\nur\t3893\net\t3838\nel\t2905\nsv\t2690\nta\t1890\nfi\t1592\ncs\t1482\nda\t1466\nno\t1339\neu\t1324\nro\t1281\ncy\t1218\nuk\t1005\nvi\t978\nne\t888\nhu\t823\nlt\t725\nlv\t625\niw\t498\nsl\t496\nis\t446\nsr\t399\nbn\t383\ngu\t339\nbg\t288\nmr\t243\nml\t231\nmy\t154\nte\t125\nkn\t123\nsi\t58\nckb\t53\npa\t44\nor\t27\nhy\t25\nps\t24\nkm\t23\nsd\t18\nka\t17\nam\t14\ndv\t6\nlo\t4\nug\t2\nbo\t1\n"}]},"apps":[],"jobName":"paragraph_1521640132569_86406514","id":"20180321-042338_1447379256","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T15:57:15+0100","dateFinished":"2018-03-21T15:57:56+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:409"},{"text":"%md\n### Extract the timeseries of languages used in twitter.\n\nIn this exercise, you will only keep the language and timestamp information (in ms since 01.01.1971 00:00:00 +00:00) of each tweet from the __twitter_one_day__ table. The result will be a table with a column __lang__ of type string and a column __time__ of type timestamp. You will store this result into a new table called __twitter_lang__.\n\nWe provide part of the query. You must fix all CHANGEME as needed in order to perform the above operation. Use the drop table command if you do not get the table right the first time.\n\n```shell\n%jdbc(hive)\n\ncreate table CHANGEME\nstored as parquet\nas\nselect\n    get_json_object(json, CHANGEME) as CHANGEME,\n    from_utc_timestamp(cast(CHANGEME as bigint), 'UTC') as CHANGEME\nfrom CHANGEME;\n```\n\n","user":"mareite","dateUpdated":"2018-03-28T15:18:43+0200","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Extract the timeseries of languages used in twitter.</h3>\n<p>In this exercise, you will only keep the language and timestamp information (in ms since 01.01.1971 00:00:00 +00:00) of each tweet from the <strong>twitter_one_day</strong> table. The result will be a table with a column <strong>lang</strong> of type string and a column <strong>time</strong> of type timestamp. You will store this result into a new table called <strong>twitter_lang</strong>.</p>\n<p>We provide part of the query. You must fix all CHANGEME as needed in order to perform the above operation. Use the drop table command if you do not get the table right the first time.</p>\n<pre><code class=\"shell\">%jdbc(hive)\n\ncreate table CHANGEME\nstored as parquet\nas\nselect\n    get_json_object(json, CHANGEME) as CHANGEME,\n    from_utc_timestamp(cast(CHANGEME as bigint), 'UTC') as CHANGEME\nfrom CHANGEME;\n</code></pre>\n"}]},"apps":[],"jobName":"paragraph_1521640132569_86406514","id":"20180320-134103_2004356345","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-28T15:18:43+0200","dateFinished":"2018-03-28T15:18:43+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:410"},{"text":"%jdbc(hive)\ndrop table if exists mareite.twitter_lang;\n\ncreate table mareite.twitter_lang\nstored as parquet\nas\nselect\n    get_json_object(json, '$.lang') as lang,\n    from_utc_timestamp(cast(get_json_object(json, '$.timestamp_ms') as bigint), 'UTC') as time\nfrom mareite.twitter_one_day;","user":"mareite","dateUpdated":"2018-03-21T16:10:56+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1521645051705_762132025","id":"20180321-161051_1562259155","dateCreated":"2018-03-21T16:10:51+0100","dateStarted":"2018-03-21T16:10:56+0100","dateFinished":"2018-03-21T16:11:32+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:411"},{"text":"%jdbc(hive)\nselect * from mareite.twitter_lang limit 10","user":"mareite","dateUpdated":"2018-03-21T16:11:45+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"twitter_lang.lang\ttwitter_lang.time\nen\t2017-11-11 08:32:00.662\nko\t2017-11-11 08:32:00.661\nen\t2017-11-11 08:32:00.659\nja\t2017-11-11 08:32:00.66\nja\t2017-11-11 08:32:00.66\nko\t2017-11-11 08:32:00.665\nja\t2017-11-11 08:32:00.658\nfr\t2017-11-11 08:32:00.657\nes\t2017-11-11 08:32:00.664\nen\t2017-11-11 08:32:00.658\n"}]},"apps":[],"jobName":"paragraph_1521644461600_927379772","id":"20180321-160101_356646545","dateCreated":"2018-03-21T16:01:01+0100","dateStarted":"2018-03-21T16:11:45+0100","dateFinished":"2018-03-21T16:11:45+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:412"},{"text":"%md\n### The mysterious Hive query\n\nCan you guess the meaning of this Hive command?\n\n```shell\n%jdbc(hive)\ncreate table CHANGEME.twitter_lang_csv\nrow format delimited\n    fields terminated by ','\n    escaped by '\"'\n    lines terminated by '\\n'\nstored as textfile\nas\nwith q as (\n    select \n        lang,\n        cast(date_format(time, 'HH') as int) as hour\n    from CHANGEME\n)\nselect lang, hour, count(*) as count\nfrom q\ngroup by lang, hour;\n```\n\nReplace all CHANGME occurences as appropriate and try it.","dateUpdated":"2018-03-21T14:48:52+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>The mysterious Hive query</h3>\n<p>Can you guess the meaning of this Hive command?</p>\n<pre><code class=\"shell\">%jdbc(hive)\ncreate table CHANGEME.twitter_lang_csv\nrow format delimited\n    fields terminated by ','\n    escaped by '\"'\n    lines terminated by '\\n'\nstored as textfile\nas\nwith q as (\n    select \n        lang,\n        cast(date_format(time, 'HH') as int) as hour\n    from CHANGEME\n)\nselect lang, hour, count(*) as count\nfrom q\ngroup by lang, hour;\n</code></pre>\n<p>Replace all CHANGME occurences as appropriate and try it.</p>\n"}]},"apps":[],"jobName":"paragraph_1521640132570_87560761","id":"20180320-135452_2072033476","dateCreated":"2018-03-21T14:48:52+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:413"},{"text":"%jdbc(hive)\ndrop table if exists  mareite.twitter_lang_time;\n\ncreate table mareite.twitter_lang_time\nstored as parquet\nas\nwith q as (\n    select \n        lang,\n        cast(date_format(time, 'HH') as int) as hour\n    from mareite.twitter_lang\n)\nselect lang, hour, count(*) as count\nfrom q\ngroup by lang, hour;","user":"mareite","dateUpdated":"2018-03-21T16:24:30+0100","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1521640132570_87560761","id":"20180321-093624_789131470","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T16:24:30+0100","dateFinished":"2018-03-21T16:24:40+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:414"},{"text":"%jdbc(hive)\nselect * from mareite.twitter_lang_time limit 5","user":"mareite","dateUpdated":"2018-03-21T16:23:09+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"twitter_lang_time.lang\ttwitter_lang_time.hour\ttwitter_lang_time.count\nnull\tnull\t904724\nam\t4\t1\nam\t7\t1\nam\t12\t2\nam\t13\t1\n"}]},"apps":[],"jobName":"paragraph_1521645176013_1711138996","id":"20180321-161256_580664818","dateCreated":"2018-03-21T16:12:56+0100","dateStarted":"2018-03-21T16:23:09+0100","dateFinished":"2018-03-21T16:23:09+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:415"},{"text":"%md \nThis query returns the number of tweets at a given hour and for a certain language. \nFor instance, how many tweets in english at 5PM ? ","user":"mareite","dateUpdated":"2018-03-21T16:23:13+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>This query returns the number of tweets at a given hour and for a certain language.\n<br  />For instance, how many tweets in english at 5PM ?</p>\n"}]},"apps":[],"jobName":"paragraph_1521645119457_-992014831","id":"20180321-161159_993092738","dateCreated":"2018-03-21T16:11:59+0100","dateStarted":"2018-03-21T16:23:13+0100","dateFinished":"2018-03-21T16:23:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:416"},{"text":"%jdbc(hive)\nselect * from mareite.twitter_lang_time where hour = 17 and lang = \"en\"\n","user":"mareite","dateUpdated":"2018-03-21T16:23:15+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"twitter_lang_time.lang\ttwitter_lang_time.hour\ttwitter_lang_time.count\nen\t17\t52633\n"}]},"apps":[],"jobName":"paragraph_1521645390112_-1102450921","id":"20180321-161630_458789008","dateCreated":"2018-03-21T16:16:30+0100","dateStarted":"2018-03-21T16:23:15+0100","dateFinished":"2018-03-21T16:23:15+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:417"},{"text":"%md\n### Display language frequencies at different times of the day\n\nIn the next query you will display the frequecny tweets in Portuguese (pt) and Korean (ko) for each hour of the day.\n\nHints: (1) Only keep the tweets where the hour is not null and the lang is in ('pt', 'ko'), (2) use the SQL __where__ clause.\n\nSelect the bar chart view in Zeppelin graph toolbar that appears with the result. Then the open the settings and arrange the output fields (drag and drop) in the keys, groups and values properties until you get an insightful plot.\n\n\n","dateUpdated":"2018-03-21T14:48:52+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Display language frequencies at different times of the day</h3>\n<p>In the next query you will display the frequecny tweets in Portuguese (pt) and Korean (ko) for each hour of the day.</p>\n<p>Hints: (1) Only keep the tweets where the hour is not null and the lang is in ('pt', 'ko'), (2) use the SQL <strong>where</strong> clause.</p>\n<p>Select the bar chart view in Zeppelin graph toolbar that appears with the result. Then the open the settings and arrange the output fields (drag and drop) in the keys, groups and values properties until you get an insightful plot.</p>\n"}]},"apps":[],"jobName":"paragraph_1521640132571_87176012","id":"20180321-094259_347812219","dateCreated":"2018-03-21T14:48:52+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:418"},{"text":"%jdbc(hive)\nselect * from mareite.twitter_lang_time where lang in ('pt','ko') and hour is not null","user":"mareite","dateUpdated":"2018-03-21T16:25:42+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"sql"},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false},"pieChart":{},"stackedAreaChart":{"style":"stream"}},"commonSetting":{},"keys":[{"name":"twitter_lang_csv.hour","index":1,"aggr":"sum"}],"groups":[{"name":"twitter_lang_csv.lang","index":0,"aggr":"sum"}],"values":[{"name":"twitter_lang_csv.count","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"twitter_lang_time.lang\ttwitter_lang_time.hour\ttwitter_lang_time.count\nko\t0\t2769\nko\t1\t4039\nko\t2\t6015\nko\t3\t7192\nko\t4\t9439\nko\t5\t9422\nko\t6\t8968\nko\t7\t8610\nko\t8\t4065\nko\t9\t9007\nko\t10\t8931\nko\t11\t9809\nko\t12\t10990\nko\t13\t11959\nko\t14\t12709\nko\t15\t13098\nko\t16\t12379\nko\t17\t9185\nko\t18\t6018\nko\t19\t3613\nko\t20\t2168\nko\t21\t1517\nko\t22\t1305\nko\t23\t1663\npt\t0\t11820\npt\t1\t11732\npt\t2\t12263\npt\t3\t11004\npt\t4\t8263\npt\t5\t5215\npt\t6\t3076\npt\t7\t1846\npt\t8\t689\npt\t9\t1616\npt\t10\t2592\npt\t11\t3884\npt\t12\t5616\npt\t13\t7552\npt\t14\t9285\npt\t15\t10257\npt\t16\t10652\npt\t17\t10515\npt\t18\t10023\npt\t19\t9816\npt\t20\t9845\npt\t21\t10381\npt\t22\t10728\npt\t23\t11368\n"}]},"apps":[],"jobName":"paragraph_1521640132571_87176012","id":"20180320-135453_712665411","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T16:25:42+0100","dateFinished":"2018-03-21T16:25:42+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:419"},{"text":"%md\n\n### Find the most retweeted users\n\nIn the next queries you will compute the list of the 50 most retweeted users.\n\nYou will first create the table __twitter_users__ and store it in __parquet__ format.\n\n```shell\n%jdbc(hive)\ncreate table CHANGEME\nstored as parquet\nas\nselect CHANGEME(json, '$.retweeted_status.user.screen_name') as name\nfrom CHANGEME\nwhere CHANGEME(json, '$.retweeted_status') is not null;\n```\n\nNext you will create the table of  the 50 most popular users in decreasing order of retweets for the day.\n\n```shell\n%jdbc(hive)\ncreate table CHANGEME.twitter_users_count\nrow format delimited\n    fields terminated by ','\n    escaped by '\"'\n    lines terminated by '\\n'\nstored as textfile\nselect name, count(*) as count\nfrom CHANGEME.twitter_users\ngroup by name\norder by count desc\nlimit 50;\n```\n\nNote that we have created the table in textfile format, and we have specified a row format as a CSV file. To wrap this exercise up, try to find this file in HDFS and use the __hdfs dfs -cat__ command to visualize it. You can then use __hdfs dfs -get__ and __scp__ or rsync to copy it on your laptop.\n","user":"mareite","dateUpdated":"2018-03-21T16:26:02+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Find the most retweeted users</h3>\n<p>In the next queries you will compute the list of the 50 most retweeted users.</p>\n<p>You will first create the table <strong>twitter_users</strong> and store it in <strong>parquet</strong> format.</p>\n<pre><code class=\"shell\">%jdbc(hive)\ncreate table CHANGEME\nstored as parquet\nas\nselect CHANGEME(json, '$.retweeted_status.user.screen_name') as name\nfrom CHANGEME\nwhere CHANGEME(json, '$.retweeted_status') is not null;\n</code></pre>\n<p>Next you will create the table of  the 50 most popular users in decreasing order of retweets for the day.</p>\n<pre><code class=\"shell\">%jdbc(hive)\ncreate table CHANGEME.twitter_users_count\nrow format delimited\n    fields terminated by ','\n    escaped by '\"'\n    lines terminated by '\\n'\nstored as textfile\nselect name, count(*) as count\nfrom CHANGEME.twitter_users\ngroup by name\norder by count desc\nlimit 50;\n</code></pre>\n<p>Note that we have created the table in textfile format, and we have specified a row format as a CSV file. To wrap this exercise up, try to find this file in HDFS and use the <strong>hdfs dfs -cat</strong> command to visualize it. You can then use <strong>hdfs dfs -get</strong> and <strong>scp</strong> or rsync to copy it on your laptop.</p>\n"}]},"apps":[],"jobName":"paragraph_1521640132571_87176012","id":"20180321-102100_1524832575","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T16:26:02+0100","dateFinished":"2018-03-21T16:26:02+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:420"},{"text":"%jdbc(hive)\ncreate table mareite.twitter_users\nstored as parquet\nas\nselect get_json_object(json, '$.retweeted_status.user.screen_name') as name\nfrom  mareite.twitter_one_day\nwhere get_json_object(json, '$.retweeted_status') is not null;","user":"mareite","dateUpdated":"2018-03-21T16:28:19+0100","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1521640132572_85252267","id":"20180320-111048_1278675940","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T16:28:19+0100","dateFinished":"2018-03-21T16:29:04+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:421"},{"text":"%jdbc(hive)\nselect * from mareite.twitter_users limit 10","user":"mareite","dateUpdated":"2018-03-21T16:33:50+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"twitter_users.name\njohnjajaran\nNicole_Zara11\nyamakou_wr\nMyoyoShinnyo\nmsh41647\nMwanMuVili\nWell086\nPattyTiu\nZodiacFacts\nNicole_Zara11\n"}]},"apps":[],"jobName":"paragraph_1521646372769_2128876134","id":"20180321-163252_2140973317","dateCreated":"2018-03-21T16:32:52+0100","dateStarted":"2018-03-21T16:33:50+0100","dateFinished":"2018-03-21T16:33:51+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:422"},{"text":"%jdbc(hive)\ncreate table mareite.twitter_users_count\nrow format delimited\n    fields terminated by ','\n    escaped by '\"'\n    lines terminated by '\\n'\nstored as textfile\nas\nselect name, count(*) as count\nfrom mareite.twitter_users\ngroup by name\norder by count desc\nlimit 50;","user":"mareite","dateUpdated":"2018-03-21T16:35:31+0100","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1521640132572_85252267","id":"20180320-111112_142668305","dateCreated":"2018-03-21T14:48:52+0100","dateStarted":"2018-03-21T16:35:31+0100","dateFinished":"2018-03-21T16:35:58+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:423"},{"text":"%jdbc(hive)\nselect * from mareite.twitter_users_count","user":"mareite","dateUpdated":"2018-03-21T16:36:12+0100","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"twitter_users_count.name\ttwitter_users_count.count\nBTS_twt\t6948\nGirlPosts\t2527\nrealDonaldTrump\t2261\nakiko_lawson\t1656\naraslanian_\t1368\ntedlieu\t1143\nFreddyAmazin\t1135\nRVsmtown\t1097\nTweetLikeAGirI\t1080\nmemeprovider\t1051\nHERTweetx\t1019\nsyeddoha\t990\nfamichikisenpai\t984\nfunder\t953\ntaylorswift13\t931\ncatsu\t930\nBleacherReport\t929\nCamila_Cabello\t880\nchocofah\t857\nZyphree_\t832\nshellywelly53\t790\np0w22alX6NgNTQd\t781\nChaoMendesPage\t777\nCocaColaJapan\t740\nmilliebbrown\t739\nAgniBankai\t727\njsmtjyygyjbbjb\t719\nbts_bighit\t719\nSoDamnTrue\t708\nfinah\t700\nalvaroga91\t680\nBT21_\t658\nhbker07\t626\n1942bs\t608\nbtsanalytics\t596\npeckpalit\t594\nfrasesdebebadas\t593\nSweetestAsshoIe\t591\ncherrywineIouis\t580\nflanchota\t578\nktrsngofficial\t576\nRecitoBobMarIey\t570\nOfficialMonstaX\t569\ntaehyungpic\t565\nJoyAnnReid\t565\nBOHHOT\t561\nthehill\t559\n90kidsx\t550\nRapSpotlightss\t549\nsw07081sw\t542\n"}]},"apps":[],"jobName":"paragraph_1521646545430_-803048402","id":"20180321-163545_1764098312","dateCreated":"2018-03-21T16:35:45+0100","dateStarted":"2018-03-21T16:36:12+0100","dateFinished":"2018-03-21T16:36:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:424"},{"text":"%md\n### That's all, folks","dateUpdated":"2018-03-21T14:48:52+0100","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>That's all, folks</h3>\n"}]},"apps":[],"jobName":"paragraph_1521640132572_85252267","id":"20180320-143329_5934928","dateCreated":"2018-03-21T14:48:52+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:425"},{"text":"%md\n","dateUpdated":"2018-03-21T14:48:52+0100","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"editOnDblClick":true,"language":"markdown"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521640132573_84867518","id":"20180321-114758_916463376","dateCreated":"2018-03-21T14:48:52+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:426"}],"name":"DSLab_week5_Hive_Exercice","id":"2DBHSP7H2","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}